openapi: 3.1.0
x-stoplight:
  id: hpx2e63mc8gcc
info:
  title: Organizations
  version: '0.1'
  description: Organizations API Collection
  summary: API Collection for organizations management
  contact:
    name: Reingold Shekhtel
    email: reingold_shekhtel@epam.com
servers:
  - url: 'http://localhost:3000'
paths:
  /organizations:
    get:
      summary: Get a list of organizations
      tags:
        - Organizations
        - Ready for implementation
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ./models/Offset.yaml
                  - x-stoplight:
                      id: nsdfmhu6y0tgj
                    type: object
                    properties:
                      items:
                        x-stoplight:
                          id: p6c0g6dra4c11
                        type: array
                        items:
                          $ref: '#/components/schemas/OrganizationProfile'
                          x-stoplight:
                            id: 8zm4xnkiool8l
                description: The list of organizations
      operationId: get-organizations
      description: Get a list of existing organizations.
      parameters:
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Sort'
        - $ref: '#/components/parameters/Order'
      requestBody:
        content: {}
    post:
      summary: Create a new organization
      operationId: post-organizations
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationInfo'
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '402':
          description: Payment Required
      description: |-
        > **Enterprise edition feature** 
        >
        > Available only if an Organization plugin is enabled.

        Create a new organization. Provide name and slug.

        Authority:

        - ADMINISTRATOR
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationDetails'
        description: |-
          You can create an organization provide name and slug.
          If the `slug` is not provided, it will be generated from the `name`.
      tags:
        - Organizations
        - Ready for implementation
  '/organizations/{org_id}':
    get:
      summary: Get organization information
      tags:
        - Organizations
        - Ready for implementation
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationProfile'
      operationId: get-organizations-org_id
      description: Provide organization information.
    parameters:
      - $ref: '#/components/parameters/OrganizationId'
    put:
      summary: Update organization
      operationId: put-organizations-org_id
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationInfo'
        '402':
          description: Payment Required
      description: |-
        > **Enterprise edition feature** 
        >
        > Available only if an Organization plugin is enabled.

        Update organization information with the provided data.

        #### Authority:

        - ADMINISTRATOR
        - MANAGER
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationDetails'
        description: Provide organization information for update.
      tags:
        - Organizations
        - Ready for implementation
      x-internal: false
    patch:
      summary: Partial organization update
      operationId: patch-organizations-org_id
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationInfo'
        '402':
          description: Payment Required
      description: |-
        > **Enterprise edition feature** 
        >
        > Available only if an Organization plugin is enabled.

        Particular organization fields update via the [JSON Merge Patch standard](https://datatracker.ietf.org/doc/html/rfc7386).
      requestBody:
        content:
          application/merge-patch+json:
            schema:
              allOf:
                - type: object
                  properties:
                    name:
                      type: string
                      x-stoplight:
                        id: 6906m5222zvx6
                - $ref: ./models/Slug.yaml
                  x-stoplight:
                    id: 4t2f16ac5xz63
        description: 'Use PATCH with JSON Merge Patch standard, a specialized media type application/merge-patch+json for partial resource representation to update parts of resource objects.'
      tags:
        - Organizations
        - Ready for implementation
      x-internal: false
    delete:
      summary: Delete organization
      operationId: delete-organizations-org_id
      responses:
        '204':
          description: No Content
        '402':
          description: Payment Required
      description: |-
        > **Enterprise edition feature** 
        >
        > Available only if an Organization plugin is enabled.

        Delete organization by identifier.
      tags:
        - Organizations
        - Ready for implementation
      x-internal: false
  '/organizations/{org_id}/users':
    parameters:
      - $ref: '#/components/parameters/OrganizationId'
    get:
      summary: Get organization's users
      tags:
        - Users
        - Ready for implementation
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ./models/Offset.yaml
                  - type: object
                    x-stoplight:
                      id: kn7zavpzj9nfz
                    properties:
                      items:
                        type: array
                        x-stoplight:
                          id: niglepk1k2g3s
                        items:
                          $ref: '#/components/schemas/OrganizationUserProfile'
                          x-stoplight:
                            id: yc96ertdqgoq3
      operationId: get-organizations-org_id-users
      description: Provides a list of organzation's users.
      requestBody:
        content: {}
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/Sort'
        - $ref: '#/components/parameters/Order'
    post:
      summary: Assignment user to organization
      operationId: post-organizations-org_id-users
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUserInfo'
        '207':
          description: Multi-Status (WebDAV)
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/OrganizationUserInfo'
                    x-stoplight:
                      id: qczj8a6wf2gxv
                  - type: object
                    properties:
                      items:
                        x-stoplight:
                          id: tv2psyijqtql3
                        type: array
                        description: |-
                          Change statuses for projects.
                          For cases when a user is assigned projects.
                        items:
                          $ref: ./models/EventStatus.yaml
                          x-stoplight:
                            id: tlxl05k73zejt
              examples:
                Fur inexisting users:
                  value:
                    role: MEMBER
                    items:
                      - id: project-1
                        status: PENDING
                        description: Will be assigned after registration
                      - id: project-2
                        status: FAILURE
                        description: Wrong project slug/id
      description: |-
        This endpoint provides a flow for bulk assigning a user to the organization and projects.
        You can provide a project list as an additional option for assigning to a user.

        You will get different statuses for project assignments according to which user you want to assign to the organization:

        - `PENDING` or `FAILURE` for non-existing users.
        - `SUCCESS` or `FAILURE` for existing users.

        Items contain statuses for each event. Inside the event, you can find the `id` that links to the identifier you provided in the request.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationUserAssignment'
            examples: {}
        description: Definition for a user assignment.
      tags:
        - Users
        - Ready for implementation
  '/organizations/{org_id}/users/{user_id}':
    parameters:
      - $ref: '#/components/parameters/OrganizationId'
      - $ref: '#/components/parameters/UserId'
    get:
      summary: Get organization user profile
      tags:
        - Users
        - Ready for implementation
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUserProfile'
        '404':
          description: Not Found
      operationId: get-organizations-org_id-users-user_id
      description: Get organization user profile.
    put:
      summary: Update organization user details
      operationId: put-organizations-org_id-users-user_id
      responses:
        '200':
          description: OK
        '207':
          description: |-
            Multi-Status (WebDAV)

            Response for a user assignment with projects.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/OrganizationUserInfo'
                    x-stoplight:
                      id: vr6fer4du1z6d
                  - type: object
                    properties:
                      items:
                        x-stoplight:
                          id: nxwqi2ot8md9m
                        type: array
                        description: |-
                          Change statuses for projects.
                          For cases when a user is assigned projects.
                        items:
                          $ref: ./models/EventStatus.yaml
                          x-stoplight:
                            id: o9wfyd597iupr
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '404':
          description: Not Found
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationUserDefinition'
        description: Organization user details for update.
      tags:
        - Users
        - Ready for implementation
      description: Update organization user details.
    patch:
      summary: Partial organization user update
      operationId: patch-organizations-org_id-users-user_id
      responses:
        '200':
          description: OK
        '207':
          description: |-
            Multi-Status (WebDAV)

            Response for a user assignment with projects.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/OrganizationUserInfo'
                  - type: object
                    x-stoplight:
                      id: ktzksl9dz8ii1
                    properties:
                      items:
                        type: array
                        x-stoplight:
                          id: 3ujdjt3ivvssf
                        description: |-
                          Change statuses for projects.
                          For cases when a user is assigned projects.
                        items:
                          $ref: ./models/EventStatus.yaml
                          x-stoplight:
                            id: q4dxrz1yz0hcd
              examples: {}
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '404':
          description: Not Found
      requestBody:
        content:
          application/merge-patch+json:
            schema:
              allOf:
                - x-stoplight:
                    id: pcco8msr17mge
                  properties:
                    role:
                      type: string
                      x-stoplight:
                        id: ux9njonecvir5
                      enum:
                        - MEMBER
                        - MANAGER
                    projects:
                      type: array
                      x-stoplight:
                        id: s4p0cyzapk47w
                      items:
                        $ref: ./models/user/UserProjectDefinition.yaml
                        x-stoplight:
                          id: huy07cjxhqn0h
              type: object
            examples: {}
        description: 'Use PATCH with JSON Merge Patch standard, a specialized media type application/merge-patch+json for partial resource representation to update parts of resource objects.'
      description: Partial organization user update.
      tags:
        - Users
        - Ready for implementation
    delete:
      summary: Unassigned organization user
      operationId: delete-organizations-org_id-users-user_id
      responses:
        '204':
          description: No Content
        '401':
          description: Unauthorized
        '404':
          description: Not Found
      description: Unassigned user from an organization and all organization projects.
      tags:
        - Users
        - Ready for implementation
  '/organizations/{org_id}/projects/':
    parameters:
      - $ref: '#/components/parameters/OrganizationId'
    get:
      summary: Get organization projects
      tags:
        - Projects
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ./models/Offset.yaml
                  - type: object
                    x-stoplight:
                      id: 98qt8fb088ryy
                    properties:
                      items:
                        type: array
                        x-stoplight:
                          id: dl8caqxxjx971
                        items:
                          $ref: ./models/project/ProjectProfile.yaml
                          x-stoplight:
                            id: audexyacafge7
      operationId: get-organizations-org_id-projects
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/Sort'
        - $ref: '#/components/parameters/Order'
      description: Get a list of organization projects.
    post:
      summary: Create a new project
      operationId: post-organizations-org_id-projects
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/project/ProjectInfo.yaml
      description: Create a new project in the organization.
      requestBody:
        content:
          application/json:
            schema:
              $ref: ./models/project/ProjectDetails.yaml
      tags:
        - Projects
  '/organizations/{org_id}/projects/{project_id}':
    parameters:
      - $ref: '#/components/parameters/OrganizationId'
      - $ref: '#/components/parameters/ProjectId'
    get:
      summary: Get project information
      tags:
        - Projects
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/project/ProjectProfile.yaml
        '404':
          description: Not Found
      operationId: get-organizations-org_id-projects-project_id
      parameters: []
      description: Get project information.
    put:
      summary: Update project
      operationId: put-organizations-org_id-projects-project_id
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/project/ProjectInfo.yaml
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '404':
          description: Not Found
      requestBody:
        content:
          application/json:
            schema:
              $ref: ./models/project/ProjectDetails.yaml
      description: Update project information.
      tags:
        - Projects
    patch:
      summary: Partial project update
      operationId: patch-organizations-org_id-projects-project_id
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/project/ProjectInfo.yaml
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '404':
          description: Not Found
      requestBody:
        content:
          application/merge-patch+json:
            schema:
              allOf:
                - type: object
                  properties:
                    name:
                      type: string
                      x-stoplight:
                        id: mytj6moteu7c7
                - $ref: ./models/Slug.yaml
                  x-stoplight:
                    id: wkb8fb6yjn6z9
        description: 'Use PATCH with JSON Merge Patch standard, a specialized media type application/merge-patch+json for partial resource representation to update parts of resource objects.'
      description: Partial project update.
      tags:
        - Projects
    delete:
      summary: Delete project
      operationId: delete-organizations-org_id-projects-project_id
      responses:
        '204':
          description: No Content
      description: Delete project.
components:
  schemas:
    OrganizationProfile:
      title: Organization
      x-stoplight:
        id: lzs7p3khz8n9d
      examples: []
      description: A comprehensive set of organization information.
      allOf:
        - $ref: '#/components/schemas/OrganizationInfo'
          x-stoplight:
            id: arejror5jwj3n
        - type: object
          x-stoplight:
            id: xxy7z5blvo389
          properties:
            relationships:
              $ref: '#/components/schemas/OrganizationRelation'
              x-stoplight:
                id: lkpinpm5hhpzy
    OrganizationInfo:
      title: Organization
      x-stoplight:
        id: x7vdhfbeaz5pu
      examples: []
      description: Various information about the organization information.
      allOf:
        - $ref: '#/components/schemas/OrganizationDetails'
          x-stoplight:
            id: 64kdwn8nva4jg
        - $ref: '#/components/schemas/OrganizationMetadata'
          x-stoplight:
            id: 2bhjwvbwlhrlb
    OrganizationDetails:
      title: Organization definition
      x-stoplight:
        id: 2gyt1v3d2gfmm
      examples: []
      description: |
        Basic information provided by the client.

        A `slug` is a unique identifying part of an organization. Generated according to the organization name if not specified by the user.
      allOf:
        - type: object
          properties:
            name:
              type: string
              x-stoplight:
                id: dz5igu0m6iy9o
              description: Organization display name.
          required:
            - name
        - $ref: ./models/Slug.yaml
          x-stoplight:
            id: x3i2u6w5oic01
    OrganizationMetadata:
      title: Organization metadata
      x-stoplight:
        id: 08jgykhqykh7b
      description: Organization metadata. Represent generated fields.
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Organization ReportPortal identifier.
        type:
          type: string
          x-stoplight:
            id: 4nf6lordbrqag
          enum:
            - INTERNAL
            - PERSONAL
            - EXTERNAL
          description: |-
            Type for automatization purposes.

            There are three types:
            - INTERNAL: created by API request.
            - PERSONAL: created for a user after the user creating. Only Enterprise edition feature.
            - EXTERNAL: created for external integrations.
        external_id:
          type: string
          x-stoplight:
            id: m0wvgkfndhpag
          description: |-
            External organization identifier.
            It is created for integration.
        created_at:
          type: string
          x-stoplight:
            id: murxta40l19cz
          format: date-time
          description: Creation date.
        updated_at:
          type: string
          x-stoplight:
            id: wy58s9p7s4l81
          format: date-time
          description: Last update date.
    OrganizationRelation:
      title: Organization relations
      x-stoplight:
        id: mvjaoy2fofepj
      type: object
      properties:
        users:
          type: object
          x-stoplight:
            id: krjw7vjy2izad
          description: General information about the organization users.
          properties:
            meta:
              type: object
              x-stoplight:
                id: d6fwspiop6x0l
              properties:
                count:
                  type: integer
                  x-stoplight:
                    id: hjzuzo3w0fblt
                  minimum: 0
                  description: Total count of users in the organization.
        projects:
          type: object
          x-stoplight:
            id: ccus3qpgo1r30
          description: General information about the organization projects.
          properties:
            meta:
              type: object
              x-stoplight:
                id: ez4r3fb2cr2ts
              properties:
                count:
                  type: integer
                  x-stoplight:
                    id: 1l7k5p1fnlpfv
                  minimum: 0
                  description: Total count of projects in the organization.
        launches:
          type: object
          x-stoplight:
            id: mwmj5j0ckj15e
          description: General information about the organization launches.
          properties:
            meta:
              type: object
              x-stoplight:
                id: s2lmbnao0c7sw
              properties:
                last_occurred_at:
                  type: string
                  x-stoplight:
                    id: l5t9kyok3gjee
                  format: date-time
                  description: Last launch occurrence date.
        billing:
          type: object
          x-stoplight:
            id: 2dmd4f0yulayn
          description: |-
            General information about the organization billing.
            Available only if a Billing plugin is enabled.
          properties:
            meta:
              type: object
              x-stoplight:
                id: kycmg6uetm4ny
              properties:
                plan_name:
                  type: string
                  x-stoplight:
                    id: an0sg4e2taicm
                  description: Plan name.
                storage_usage:
                  type: integer
                  x-stoplight:
                    id: kfsaova2wetdj
                  minimum: 0
                  description: Storage usage in percents.
      description: |-
        A relationship object contains members that represent a relationship of the organization.

        Represents [JSON:API relationships object](https://jsonapi.org/format/#document-resource-object-relationships). We use only `links` and `meta` objects.
    OrganizationUserAssignment:
      title: Organization user assignment
      x-stoplight:
        id: do613cpv1l3mq
      allOf:
        - type: object
          x-stoplight:
            id: 2uhe2kffvezvt
          properties:
            email:
              type: string
              x-stoplight:
                id: sufi4vxtjz3kw
              format: email
              description: User email for assignment.
          required:
            - email
        - $ref: '#/components/schemas/OrganizationUserDefinition'
          x-stoplight:
            id: fkz8x6jcbf9uo
      description: Definition for a user assignment to the organization.
    OrganizationUserDefinition:
      title: Organization user definition
      x-stoplight:
        id: u52hc1apf7q2q
      allOf:
        - $ref: '#/components/schemas/OrganizationUserDetails'
        - type: object
          x-stoplight:
            id: nh1gunacinw5v
          properties:
            projects:
              x-stoplight:
                id: 7qf3duno409l9
              type: array
              description: |-
                List of projects for user assignment.
                It's optional; you can assign the user 
                to an organization without projects.
              items:
                $ref: ./models/user/UserProjectDefinition.yaml
                x-stoplight:
                  id: fmzilkgtzpdmu
      description: Base information about a user in an organization.
    OrganizationUserProfile:
      title: Organization user profile
      x-stoplight:
        id: mtgs7v0icru14
      allOf:
        - $ref: '#/components/schemas/OrganizationUserInfo'
          x-stoplight:
            id: z9t6c1tqs0zl7
        - $ref: ./models/user/UserAccountInfo.yaml
          x-stoplight:
            id: 2hn2quqj2tknt
        - type: object
          x-stoplight:
            id: ryd1bkgqoi60r
          properties:
            relationships:
              $ref: '#/components/schemas/OrganizationUserRelation'
              x-stoplight:
                id: 40bx6wtd0uvnz
      description: A comprehensive set of user information related to a user's organization.
    OrganizationUserInfo:
      title: Organization user information
      x-stoplight:
        id: snwrtcmq8wvt1
      allOf:
        - $ref: '#/components/schemas/OrganizationUserDetails'
        - $ref: '#/components/schemas/OrganizationUserMetadata'
          x-stoplight:
            id: 0ao0t2fs2p7gc
      description: Related information about a user in the organization.
    OrganizationUserDetails:
      title: Organization user details
      x-stoplight:
        id: 5nqrewxfku9tn
      type: object
      description: Basic information about a user in the organization.
      properties:
        role:
          type: string
          x-stoplight:
            id: 3v2e1cyby216c
          enum:
            - MEMBER
            - MANAGER
          description: Organization user role.
      required:
        - role
    OrganizationUserMetadata:
      title: Organization user metadata
      x-stoplight:
        id: g7a81q7nu3zgo
      allOf:
        - x-stoplight:
            id: 3b9125n1gljg0
          properties:
            assigned_at:
              type: string
              x-stoplight:
                id: a7gp7z7wei0p6
              format: date-time
              description: |-
                A time when a user was assigned to
                the organization.
      description: User's organization metadata. Represent generated fields.
      type: object
    OrganizationUserRelation:
      title: Organization user relations
      x-stoplight:
        id: 0v55lmrhzuy8t
      type: object
      description: |-
        A relationship object contains members that represent a relationship of the user in the organization.

        Represents [JSON:API relationships object](https://jsonapi.org/format/#document-resource-object-relationships). We use only `links` and `meta` objects.
      properties:
        projects:
          type: object
          x-stoplight:
            id: liq2focmyttih
          description: User's projects relations.
          properties:
            meta:
              type: object
              x-stoplight:
                id: p06xmlipg4irk
              description: User's projects relation metadata.
              properties:
                count:
                  type: integer
                  x-stoplight:
                    id: 3tcj2ts8foup5
                  minimum: 0
                  description: |-
                    Total number of user's projects in
                    organization.
  parameters:
    OrganizationId:
      name: org_id
      in: path
      required: true
      schema:
        type: string
      description: Organization identifier
    Limit:
      name: limit
      in: query
      required: false
      schema:
        type: string
        default: '10'
      description: The limit used for this page of results. This will be the same as the limit query parameter unless it exceeded the maximum value allowed for this API endpoint
    Offset:
      name: offset
      in: query
      required: false
      schema:
        type: string
        default: '0'
      description: The offset used for this page of results
    Sort:
      name: sort
      in: query
      required: false
      schema:
        type: string
      description: Indicate sort by field
    Order:
      name: order
      in: query
      required: false
      schema:
        type: string
      description: Indicate sorting direction
    UserId:
      name: user_id
      in: path
      required: true
      schema:
        type: string
      description: User identifier
    ProjectId:
      name: project_id
      in: path
      required: true
      schema:
        type: string
      description: Project identifier
    ProjectKey:
      name: project_key
      in: path
      required: true
      schema:
        type: string
      description: Project key
  requestBodies: {}
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: ''
tags:
  - name: Organizations
  - name: Projects
  - name: Ready for implementation
  - name: Users
security:
  - BearerAuth: []
