syntax = "proto3";

package reportportal.reporting.v1;

option java_multiple_files = true;
option java_package = "com.epam.reportportal.reporting.v1";
option java_outer_classname = "ReportPortalProto";
option objc_class_prefix = "RPP";

service ReportPortalReporting {
  rpc Upload(EntityRequest) returns (EntityResponse) {}
  rpc UploadStream(stream EntityRequest) returns (stream EntityResponse) {}
}

message EntityRequest {
  string uuid = 1;
  oneof payload {
    StartExecutionRequest start_launch_request = 2;
    FinishExecutionRequest finish_launch_request = 3;
    StartTestItemRequest start_item_request = 4;
    FinishTestItemRequest finish_item_request = 5;
    SaveLogRequest save_log_request = 6;
    SaveDataRequest save_data_request = 7;
  }
}

message StartExecutionRequest {
  string name = 1;
}

message FinishExecutionRequest {
}

message StartTestItemRequest {
  repeated PathElement path = 2;
}

message FinishTestItemRequest {
  ItemStatus status = 2;
}

message SaveLogRequest {
}

message SaveDataRequest {
}

message EntityResponse {
  string uuid = 1;
  OperationResult result = 2;
  string message = 3;
}

message PathElement {
  string name = 1;
  PathElementType type = 2;
}

enum OperationResult {
  OK = 0;
  FAIL = 1;
}

enum PathElementType {
  SUITE = 0;
  PARENT_SUITE = 1; // Do we need it?
  CHILD_SUITE = 2; // Do we need it?
  SCENARIO = 3;
  FEATURE = 4;
  PACKAGE = 5;
  TEST = 6;
  TEST_CLASS = 7;
  TEST_METHOD = 8;
}

enum ItemStatus {
  PASSED = 0;
  FAILED = 1;
  SKIPPED = 2;
  STOPPED = 3;
  INTERRUPTED = 4;
  CANCELLED = 5;
  INFO = 6;
  WARN = 7;
}
